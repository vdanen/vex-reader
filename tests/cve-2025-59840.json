{
  "document": {
    "aggregate_severity": {
      "namespace": "https://access.redhat.com/security/updates/classification/",
      "text": "Important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright © Red Hat, Inc. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "legal_disclaimer",
        "text": "This content is licensed under the Creative Commons Attribution 4.0 International License (https://creativecommons.org/licenses/by/4.0/). If you distribute this content, or a modified version of it, you must provide attribution to Red Hat Inc. and provide a link to the original.",
        "title": "Terms of Use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://access.redhat.com/security/team/contact/",
      "issuing_authority": "Red Hat Product Security is responsible for vulnerability handling across all Red Hat products and services.",
      "name": "Red Hat Product Security",
      "namespace": "https://www.redhat.com"
    },
    "references": [
      {
        "category": "self",
        "summary": "Canonical URL",
        "url": "https://security.access.redhat.com/data/csaf/v2/vex/2025/cve-2025-59840.json"
      }
    ],
    "title": "vega: vega-expression: vega-interpreter: Cross-Site Scripting (XSS) via expressions abusing toString calls in environments using the VEGA_DEBUG global variable",
    "tracking": {
      "current_release_date": "2025-11-17T05:34:25+00:00",
      "generator": {
        "date": "2025-11-17T05:34:25+00:00",
        "engine": {
          "name": "Red Hat SDEngine",
          "version": "4.6.12"
        }
      },
      "id": "CVE-2025-59840",
      "initial_release_date": "2025-11-13T19:54:26.256000+00:00",
      "revision_history": [
        {
          "date": "2025-11-13T19:54:26.256000+00:00",
          "number": "1",
          "summary": "Initial version"
        },
        {
          "date": "2025-11-17T05:31:44+00:00",
          "number": "2",
          "summary": "Current version"
        },
        {
          "date": "2025-11-17T05:34:25+00:00",
          "number": "3",
          "summary": "Last generated version"
        }
      ],
      "status": "final",
      "version": "3"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "Logging Subsystem for Red Hat OpenShift",
                "product": {
                  "name": "Logging Subsystem for Red Hat OpenShift",
                  "product_id": "logging_subsystem_for_red_hat_openshift",
                  "product_identification_helper": {
                    "cpe": "cpe:/a:redhat:logging:5"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "Logging Subsystem for Red Hat OpenShift"
          },
          {
            "category": "product_version",
            "name": "openshift-logging/elasticsearch6-rhel9",
            "product": {
              "name": "openshift-logging/elasticsearch6-rhel9",
              "product_id": "openshift-logging/elasticsearch6-rhel9",
              "product_identification_helper": {
                "purl": "pkg:oci/elasticsearch6-rhel9?repository_url=registry.redhat.io/openshift-logging/elasticsearch6-rhel9"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-logging/elasticsearch-operator-bundle",
            "product": {
              "name": "openshift-logging/elasticsearch-operator-bundle",
              "product_id": "openshift-logging/elasticsearch-operator-bundle",
              "product_identification_helper": {
                "purl": "pkg:oci/elasticsearch-operator-bundle?repository_url=registry.redhat.io/openshift-logging/elasticsearch-operator-bundle"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-logging/elasticsearch-proxy-rhel9",
            "product": {
              "name": "openshift-logging/elasticsearch-proxy-rhel9",
              "product_id": "openshift-logging/elasticsearch-proxy-rhel9",
              "product_identification_helper": {
                "purl": "pkg:oci/elasticsearch-proxy-rhel9?repository_url=registry.redhat.io/openshift-logging/elasticsearch-proxy-rhel9"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-logging/elasticsearch-rhel9-operator",
            "product": {
              "name": "openshift-logging/elasticsearch-rhel9-operator",
              "product_id": "openshift-logging/elasticsearch-rhel9-operator",
              "product_identification_helper": {
                "purl": "pkg:oci/elasticsearch-rhel9-operator?repository_url=registry.redhat.io/openshift-logging/elasticsearch-rhel9-operator"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-logging/kibana6-rhel8",
            "product": {
              "name": "openshift-logging/kibana6-rhel8",
              "product_id": "openshift-logging/kibana6-rhel8",
              "product_identification_helper": {
                "purl": "pkg:oci/kibana6-rhel8?repository_url=registry.redhat.io/openshift-logging/kibana6-rhel8"
              }
            }
          },
          {
            "category": "product_version",
            "name": "openshift-logging/logging-curator5-rhel9",
            "product": {
              "name": "openshift-logging/logging-curator5-rhel9",
              "product_id": "openshift-logging/logging-curator5-rhel9",
              "product_identification_helper": {
                "purl": "pkg:oci/logging-curator5-rhel9?repository_url=registry.redhat.io/openshift-logging/logging-curator5-rhel9"
              }
            }
          }
        ],
        "category": "vendor",
        "name": "Red Hat"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/elasticsearch-operator-bundle as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-operator-bundle"
        },
        "product_reference": "openshift-logging/elasticsearch-operator-bundle",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/elasticsearch-proxy-rhel9 as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-proxy-rhel9"
        },
        "product_reference": "openshift-logging/elasticsearch-proxy-rhel9",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/elasticsearch-rhel9-operator as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-rhel9-operator"
        },
        "product_reference": "openshift-logging/elasticsearch-rhel9-operator",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/elasticsearch6-rhel9 as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel9"
        },
        "product_reference": "openshift-logging/elasticsearch6-rhel9",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/kibana6-rhel8 as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/kibana6-rhel8"
        },
        "product_reference": "openshift-logging/kibana6-rhel8",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "openshift-logging/logging-curator5-rhel9 as a component of Logging Subsystem for Red Hat OpenShift",
          "product_id": "logging_subsystem_for_red_hat_openshift:openshift-logging/logging-curator5-rhel9"
        },
        "product_reference": "openshift-logging/logging-curator5-rhel9",
        "relates_to_product_reference": "logging_subsystem_for_red_hat_openshift"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2025-59840",
      "cwe": {
        "id": "CWE-79",
        "name": "Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting')"
      },
      "discovery_date": "2025-11-13T20:01:24.574826+00:00",
      "flags": [
        {
          "label": "vulnerable_code_not_present",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-operator-bundle",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-proxy-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-rhel9-operator",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/logging-curator5-rhel9"
          ]
        }
      ],
      "ids": [
        {
          "system_name": "Red Hat Bugzilla ID",
          "text": "2414907"
        }
      ],
      "notes": [
        {
          "category": "description",
          "text": "A cross-site scripting (XSS) vulnerability has been identified in the Vega visualization library when applications accept user-supplied Vega specifications and expose Vega objects on the global browser window. An attacker can craft a malicious Vega specification that triggers hidden JavaScript execution through a toString() side effect, leading to DOM-based XSS that may appear reflected or stored depending on how the library is used. When a user opens or interacts with the malicious spec, arbitrary JavaScript executes in the application’s domain, allowing an attacker to steal authentication tokens, manipulate displayed data, or perform unauthorized actions on behalf of the victim, compromising both the confidentiality and integrity of affected applications.",
          "title": "Vulnerability description"
        },
        {
          "category": "summary",
          "text": "vega: vega-expression: vega-interpreter: Cross-Site Scripting (XSS) via expressions abusing toString calls in environments using the VEGA_DEBUG global variable",
          "title": "Vulnerability summary"
        },
        {
          "category": "other",
          "text": "This vulnerability affects the Vega visualization library when applications expose the Vega runtime or a vega.View instance on the global browser window, a pattern commonly introduced for debugging or interactive development.\n\nRed Hat Product Security has rated this issue High severity, because a remote attacker can craft a malicious Vega specification that, once opened and interacted with by a user, triggers arbitrary script execution in the application’s origin.\n\nThe practical impact requires and depends on specific deployment conditions. Applications are only exposed if they (1) accept or render untrusted Vega specifications and (2) must expose Vega objects globally (such as VEGA_DEBUG, vega, or view attached to window). Applications that do not expose these global debugging gadgets or that only render trusted specifications are not affected.",
          "title": "Statement"
        },
        {
          "category": "general",
          "text": "The CVSS score(s) listed for this vulnerability do not reflect the associated product's status, and are included for informational purposes to better understand the severity of this vulnerability.",
          "title": "CVSS score applicability"
        }
      ],
      "product_status": {
        "known_affected": [
          "logging_subsystem_for_red_hat_openshift:openshift-logging/kibana6-rhel8"
        ],
        "known_not_affected": [
          "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-operator-bundle",
          "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-proxy-rhel9",
          "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-rhel9-operator",
          "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel9",
          "logging_subsystem_for_red_hat_openshift:openshift-logging/logging-curator5-rhel9"
        ]
      },
      "references": [
        {
          "category": "self",
          "summary": "Canonical URL",
          "url": "https://access.redhat.com/security/cve/CVE-2025-59840"
        },
        {
          "category": "external",
          "summary": "RHBZ#2414907",
          "url": "https://bugzilla.redhat.com/show_bug.cgi?id=2414907"
        },
        {
          "category": "external",
          "summary": "https://www.cve.org/CVERecord?id=CVE-2025-59840",
          "url": "https://www.cve.org/CVERecord?id=CVE-2025-59840"
        },
        {
          "category": "external",
          "summary": "https://nvd.nist.gov/vuln/detail/CVE-2025-59840",
          "url": "https://nvd.nist.gov/vuln/detail/CVE-2025-59840"
        },
        {
          "category": "external",
          "summary": "https://github.com/vega/vega/security/advisories/GHSA-7f2v-3qq3-vvjf",
          "url": "https://github.com/vega/vega/security/advisories/GHSA-7f2v-3qq3-vvjf"
        }
      ],
      "release_date": "2025-11-13T19:54:26.256000+00:00",
      "remediations": [
        {
          "category": "workaround",
          "details": "Do not attach vega or vega.View instances to global objects (e.g., window). Remove any VEGA_DEBUG helpers or debugging hooks from production builds.\n\nThese mitigations reduce but do not fully eliminate risk, because the underlying vulnerability exists in the expression evaluation design.",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-operator-bundle",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-proxy-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-rhel9-operator",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/kibana6-rhel8",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/logging-curator5-rhel9"
          ]
        },
        {
          "category": "none_available",
          "details": "Affected",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/kibana6-rhel8"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "attackComplexity": "LOW",
            "attackVector": "NETWORK",
            "availabilityImpact": "NONE",
            "baseScore": 8.1,
            "baseSeverity": "HIGH",
            "confidentialityImpact": "HIGH",
            "integrityImpact": "HIGH",
            "privilegesRequired": "NONE",
            "scope": "UNCHANGED",
            "userInteraction": "REQUIRED",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:N/UI:R/S:U/C:H/I:H/A:N",
            "version": "3.1"
          },
          "products": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-operator-bundle",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-proxy-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-rhel9-operator",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/kibana6-rhel8",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/logging-curator5-rhel9"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "details": "Important",
          "product_ids": [
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-operator-bundle",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-proxy-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch-rhel9-operator",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/elasticsearch6-rhel9",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/kibana6-rhel8",
            "logging_subsystem_for_red_hat_openshift:openshift-logging/logging-curator5-rhel9"
          ]
        }
      ],
      "title": "vega: vega-expression: vega-interpreter: Cross-Site Scripting (XSS) via expressions abusing toString calls in environments using the VEGA_DEBUG global variable"
    }
  ]
}